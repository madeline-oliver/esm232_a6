---
title: "ESM 232 Assignment 6"
author: "Madeline Oliver, Ruben Sanchez, Atefeh Mohseni"
date: "5/5/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(deSolve)
library(sensitivity)
```

# Model of forest growth (where forest size in measured in units of carbon (C))

* dC/dt  = r*C for forests where carbon is below a canopy closure threshold 

* dC/dt = g  for forests where carbon is  at or above the threshold canopy closure

* dC/dt = 0 once a carrying capacity (K) is reached.

The size of the forest (C), Canopy closure threshold and carrying capacity are all in units of carbon 

**Canopy closure threshold:** the size of the forest at which growth rates change from exponential to linear

**r:** early exponential growth rate 

**g:** linear growth rate once canopy closure has been reached

# Run model for 300 years (using the ODE solver) starting with an initial forest size of 10 kg/C and using the following parameters:

* canopy closure threshold = 50 kgC 

* K = 250 kg C (carrying capacity) 

* r=  0.01 (exponential growth rate before before canopy closure)

* g = 2 kg/year (linear growth rate after canopy closure)


```{r}
# source model
source("forest_growth.R")

# set parameters

years = seq(from=1, to=300, by=1)
initial_forest = 10
thresh = 50
K = 250
r = 0.01
g = 2

# create parameter list
parms = list(thresh = thresh, K=K, r=r, g=g)

# run ODE 
results = ode(y=initial_forest, 
              time=years, 
              func=forest_growth, 
              parms=parms)

colnames(results)=c("year","forest_size")
head(results)

# graph results
ggplot(as.data.frame(results), aes(year,forest_size))+
  geom_point()+
  labs(y="Forest Carbon", "Years")

```


